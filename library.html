---
layout: strudel
title: library
permalink: /library/
---

<div id="json">
  <div class="my ms">
    <span class="key">"library"</span>: <span class="value">"<a href="{{ '/' | relative_url }}">back to home</a>"</span>
  </div>
</div>

<div id="tracks-list"></div>

<script type="module">
  // List your track files here
  const tracks = [
    { file: 'track01.txt', title: 'first try', date: '12/2/25' },
    // Add more tracks here as you create them:
    // { file: 'track02.txt', title: 'second track', date: '12/3/25' },
  ];

  const tracksList = document.getElementById('tracks-list');

  for (let i = 0; i < tracks.length; i++) {
    const track = tracks[i];
    const trackId = `track-${i}`;
    
    // Create track entry in JSON style
    const trackEntry = document.createElement('div');
    trackEntry.className = 'my ms';
    trackEntry.innerHTML = `
      <span class="key">"${track.title}"</span>: {
      <div class="ms">
        <span class="key">"date"</span>: <span class="value">"${track.date}"</span>,<br>
        <span class="key">"play"</span>: <span class="value"><a href="#" id="play-${trackId}" style="color: var(--oc-green-5);">"click to load"</a></span>
      </div>
      }${i < tracks.length - 1 ? ',' : ''}
    `;
    tracksList.appendChild(trackEntry);
    
    // Create container for Strudel player (hidden initially)
    const strudelContainer = document.createElement('div');
    strudelContainer.id = `strudel-${trackId}`;
    strudelContainer.style.display = 'none';
    strudelContainer.style.marginBottom = '30px';
    tracksList.appendChild(strudelContainer);
    
    // Add click handler
    document.getElementById(`play-${trackId}`).addEventListener('click', async (e) => {
      e.preventDefault();
      
      const container = document.getElementById(`strudel-${trackId}`);
      
      // If already loaded, just toggle visibility
      if (container.innerHTML !== '') {
        container.style.display = container.style.display === 'none' ? 'block' : 'none';
        e.target.textContent = container.style.display === 'none' ? '"click to load"' : '"hide player"';
        return;
      }
      
      // Load the track
      try {
        const url = `{{ "/assets/tracks/" | relative_url }}${track.file}`;
        const response = await fetch(url);
        
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const code = await response.text();
        const strudelRepl = document.createElement('strudel-repl');
        strudelRepl.setAttribute('code', code);
        
        container.appendChild(strudelRepl);
        container.style.display = 'block';
        e.target.textContent = '"hide player"';
        
      } catch (error) {
        console.error(`Error loading ${track.file}:`, error);
        container.innerHTML = `<p style="color: red;">Error loading track</p>`;
        container.style.display = 'block';
      }
    });
  }
</script>
